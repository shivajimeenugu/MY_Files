function main(workbook: ExcelScript.Workbook) {
  // Define the main sheet name
  const mainSheetName = "MainSheet"; // Replace with the name of your main sheet
  const monitoredSheetNames = ["Sheet1", "Sheet2"]; // Replace with the names of the sheets you want to monitor

  // Loop through each monitored sheet
  monitoredSheetNames.forEach(sheetName => {
    const sheet = workbook.getWorksheet(sheetName);
    if (sheet) {
      const range = sheet.getUsedRange();
      if (range) {
        const rowCount = range.getRowCount();
        const columnCount = range.getColumnCount();

        // Loop through each row in the first column
        for (let row = 0; row < rowCount; row++) {
          const cell = sheet.getCell(row, 0);
          const newSheetName = cell.getText();

          if (newSheetName && !workbook.getWorksheet(newSheetName)) {
            // Create a new sheet
            const newSheet = workbook.addWorksheet(newSheetName);

            // Insert a hyperlink in the cell to the new sheet
            cell.getHyperlink().set({
              textToDisplay: newSheetName,
              location: `${newSheetName}!A1`
            });

            // Create a back button shape in the new sheet
            const backShape = newSheet.addShape(
              ExcelScript.ShapeType.actionButtonBackPrevious,
              10, 10, 50, 50
            );
            backShape.getText().setText("Back");

            // Add a hyperlink to the main sheet
            backShape.getHyperlink().set({
              textToDisplay: "Back",
              location: `${mainSheetName}!A1`
            });
          }
        }
      }
    }
  });
}
